#!/bin/bash

set -eu -o pipefail

if [[ -n "${DOCKER_HUB_USER:-}" && -n "${DOCKER_HUB_PASSWORD:-}" ]] ; then
  echo "~~~ Authenticating with Docker Hub as ${DOCKER_HUB_USER}"

  [[ -f ~/.docker/config.json ]] && rm ~/.docker/config.json

  docker login --username="${DOCKER_HUB_USER}" --password="${DOCKER_HUB_PASSWORD}"

  unset DOCKER_HUB_USER
  unset DOCKER_HUB_PASSWORD
fi
